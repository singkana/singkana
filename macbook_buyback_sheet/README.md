# MacBook 出張買取ツール（スマホ運用：Googleスプレッドシート）

出張買取の現場で **スマホからスプシに入力するだけ** で、概算の買取見積レンジを自動計算するためのテンプレです。

## できること

- **「入力」シート**に行を追加して項目を埋めると、`見積下限/上限` が自動で更新されます（`onEdit`）。
- **見積ID** を自動発行します（例: `MBQ-20260205-8F3K2`）。
- 相場の更新は **「設定」シートのベース価格** を編集するだけで反映できます。
- 減額ロジックも **「設定」シートの減額テーブル** を編集して調整できます。

## 導入（最短）

1. Googleスプレッドシートを新規作成
2. `拡張機能 → Apps Script` を開く
3. このリポジトリの `macbook_buyback_sheet/Code.gs` を貼り付ける（既存のコードは置き換え）
4. `macbook_buyback_sheet/appsscript.json` の内容を `appsscript.json` に反映
5. スクリプトエディタで `setupMacbookBuybackSheet` を実行（初回のみ）
   - 権限を要求されたら許可
6. スプレッドシートに `入力` / `設定` シートが作成されればOK

以後は、スマホ（Google Sheetsアプリ）で `入力` シートに記入するだけで運用できます。

## 運用フロー（現場）

1. `入力` シートで **新しい行**を作る
2. `機種〜修理歴/水没`（E〜P列）を埋める
3. 自動で `見積下限/上限`（V〜W列）と `連絡文`（Z列）が生成される
4. `連絡文` をお客様に送る（LINE/メールでコピペ）
5. 成約/訪問予定などに応じて `ステータス`（X列）を更新

## カスタマイズ（相場更新）

### ベース価格（設定シート）

`設定` シート上部の **BASE_PRICE（ベース価格テーブル）** を更新します。

- 行は「マッチ（完全一致 or ワイルドカード `*`）」で選ばれます
- `*` は「なんでもOK」を意味します（例：`Intel` は年式/画面/メモリ/SSD を `*` にして幅を持たせる）
- **優先順位**: より多くの列が一致する行が優先（`*`が少ない行が勝ち）

CSVを貼り付けて更新する場合は、このフォルダの `base_prices.sample.csv` を参考にしてください。

### 減額（設定シート）

`設定` シート下部の **DEDUCTIONS（減額テーブル）** を更新します。

- `要素`（grade/battery/screen/keyboard/accessories/repair）× `選択肢` の組み合わせで減額を引きます
- 金額はマイナスで入れる想定（例：`-10000`）

CSVは `deductions.sample.csv` を参考にしてください。

## よくある注意（現場トラブル回避）

- **アクティベーションロック解除**（iCloudサインアウト/「探す」OFF）できない場合は基本的に買取不可扱いにする
- 充放電回数・バッテリー最大容量が不明な場合は `Unknown` を選び、保守的に見積
- 画面割れ/表示不良は `Damage` を選び、必ず現物確認を優先

